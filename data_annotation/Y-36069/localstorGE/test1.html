<!DOCTYPE html>
<html>
<head>
<title>Save Select Option in LocalStorage</title>
</head>
<body>

<select id="mySelect">
  <option value="apple">Apple</option>
  <option value="banana">Banana</option>
  <option value="orange">Orange</option>
  <option value="grape">Grape</option>
</select>

<script>
  const selectElement = document.getElementById('mySelect');
  const storedValue = localStorage.getItem('selectedOption');

  // Set selected option from localStorage if available
  if (storedValue) {
    selectElement.value = storedValue;

    // Dispatch a change event to trigger any associated listeners
    // This is crucial if you have other code depending on the select's change
   selectElement.dispatchEvent(new Event('change'));
  }

  // Save selected option to localStorage on change
  selectElement.addEventListener('change', function() {
    localStorage.setItem('selectedOption', this.value);
  });


//Auto click/trigger the change event after page load if a value is stored.
window.addEventListener('load', (event) => {
    if(storedValue){
        //Option 1: Directly set the value (already done above) and trigger the change event (also already done above)
        //This is the cleaner and preferred way

        //Option 2: Simulate a click (less reliable, especially with complex interactions)
        //selectElement.click(); // This might not always work as expected

        //Option 3: Programmatically change the value (already done above) and trigger the change event (also already done above)
        //This is also a correct way.

        console.log('Page fully loaded');
    }

});

</script>

</body>
</html>
