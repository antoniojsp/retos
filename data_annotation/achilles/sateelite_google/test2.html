<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCs-TZf18pOGm4jnsC_LfSb5AtCgeoBprE&libraries=places,drawing"></script>
<script src="https://cdn.jsdelivr.net/npm/@turf/turf/turf.min.js"></script>

</head>
<body>
<script>
  let map;
  let drawingManager;
  let selectedShape;
  let geocoder;

  function initMap() {
    map = new google.maps.Map(document.getElementById('map'), {
      zoom: 15,
      center: {lat: -34.397, lng: 150.644},
      mapTypeId: 'satellite'
    });

    geocoder = new google.maps.Geocoder();

    const input = document.getElementById('search-bar');
    const autocomplete = new google.maps.places.Autocomplete(input);
    autocomplete.bindTo('bounds', map);

    autocomplete.addListener('place_changed', () => {
      const place = autocomplete.getPlace();
      if (!place.geometry) {
        return;
      }

      if (place.geometry.viewport) {
        map.fitBounds(place.geometry.viewport);
      } else {
        map.setCenter(place.geometry.location);
        map.setZoom(17);
      }
    });

    // Initialize the drawing manager
    drawingManager = new google.maps.drawing.DrawingManager({
      drawingMode: google.maps.drawing.OverlayType.POLYGON,
      drawingControl: true,
      drawingControlOptions: {
        position: google.maps.ControlPosition.TOP_CENTER,
        drawingModes: ['polygon']
      }
    });
    drawingManager.setMap(map);

    google.maps.event.addListener(drawingManager, 'overlaycomplete', (event) => {
      if (event.type == google.maps.drawing.OverlayType.POLYGON) {
        if (selectedShape) {
          selectedShape.setMap(null);
        }
        selectedShape = event.overlay;
        calculateArea(selectedShape.getPath());
      }
    });
  }

  function calculateArea(path) {
    const coordinates = [];
    path.forEach(latLng => {
      coordinates.push([latLng.lng(), latLng.lat()]);
    });

    if (coordinates.length > 2) {
      const polygon = turf.polygon([coordinates]);
      const area = turf.area(polygon);
      const squareFeet = area * 10.7639;
      document.getElementById('sqft').innerText = squareFeet.toFixed(2);
    }
  }

  // Initialize the map after the browser has loaded the page
  window.onload = initMap;
</script>
<div>
  <input id="search-bar" type="text" placeholder="Enter your address" />
  <div id="map" style="height: 500px;"></div>
  <div id="output">
    <p>Total Square Footage: <span id="sqft"></span></p>
  </div>
</div>
</body>
</html>